# --- General Settings ---
set -g default-terminal "xterm-ghostty"
# FIX: force rgb/true color
set -as terminal-features ",xterm-ghostty:256:RGB:UTF8"
set -as terminal-overrides ",xterm-ghostty:nc"
set -ag terminal-overrides ",xterm-ghostty:Tc"
set -g default-shell /usr/bin/zsh
set -g mouse on
set -sg escape-time 0
set -g focus-events on


# Nav
unbind C-b
set -g prefix C-s
bind C-s send-prefix
unbind r
bind r source-file ~/.tmux.conf \; display " Tmux config reloaded!"
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

bind H set status

# --- UI & Window Management ---
set -g base-index 1
setw -g pane-base-index 1
set -g status-position top
set -g status-interval 2
set -g allow-passthrough on


# -----------------------------------------------------------------------------
# --- THE CUSTOM BAR BUILD ---
# -----------------------------------------------------------------------------


set -g pane-border-style fg=#a0a8cd
set -g pane-active-border-style fg=#9EEF00
set -g status on
#set -g 'status-format[1]' ''
set -g status-justify centre


# Hardcode your tokyodark hex #11121d here. 
# Do NOT use "bg=default", as tmux interprets "default" incorrectly in Ghostty sometimes.
set -g status-style "bg=#11121D,fg=#a0a8cd"

# LEFT SIDE:
set -g @net_speed_format "%7s %7s" 
set -g @net_speed_interfaces 'wlan0' # Ensure this matches `ip link` output
run-shell -b 'while true; do ~/.local/bin/tmux-net-status.sh; sleep 5; done'
set -g status-left-length 200
set -g status-left "#[fg=#11121D,bold]#[bg=#11121D,fg=#a0a8cd,bold]\u00a0#S#[bg=default,fg=#11121D,bold]#[fg=#a0a8cd]#{@net_status}\u00a0#{net_speed}#[default]"


# WINDOW LIST:
set -g window-status-format "#[fg=#343434] #I:#W "
#set -g window-status-current-format "#[fg=#9EEF00, bold]#[bg=#9EEF00,fg=#9EEF00,bold]#I:#W#[fg=#9EEF00, bold]"
set -g window-status-current-format "#[fg=#11121D,bold]#[bg=#11121D,fg=#95c561,bold]#I:#W#[bg=#11121D,fg=#11121D,bold]#[#11121D]"


# RIGHT SIDE:
set -g status-right-length 200
#set -g status-right "#{?client_prefix,#[fg=#ee6d85]#[bold],#[fg=#343434]#[nobold]}MOD #[fg=#a0a8cd,bold] #[fg=#a0a8cd,bold]PWR #{battery_percentage} #[fg=#a0a8cd,bold] #[fg=#a0a8cd]MEM #{ram_percentage} #[fg=#a0a8cd,bold] #[fg=#a0a8cd,bold][%H:%M]  "
#set -g status-right "#{?client_prefix,#[fg=#ee6d85]#[bold],#[fg=#343434]#[nobold]}MOD  #[default]#[fg=#a0a8cd,bold]PWR #{battery_percentage} #[fg=#a0a8cd]MEM #{ram_percentage} #[fg=#9EEF00,bold]#[bg=#9EEF00,fg=#11121D,bold]%H:%M#[bg=default,fg=#9EEF00,bold]#[default]"
set -g status-right "#{?client_prefix,#[fg=#ee6d85]#[bold],#[fg=#343434]#[nobold]} PREFIX\u00a0#[default]#[fg=#a0a8cd,bold] 󰁹\u00a0#{battery_percentage}\u00a0#[fg=#a0a8cd]  \u00a0#{ram_percentage}\u00a0#[fg=#11121D,bold]󰍞#[bg=#11121D,fg=#a0a8cd,bold]%H:%M#[bg=11121D,fg=#9EEF00,bold]#[default]\u00a0"



# Plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-cpu'
set -g @plugin 'tmux-plugins/tmux-battery'
set -g @plugin 'jimeh/tmux-net-speed'


run '~/.tmux/plugins/tpm/tpm'
